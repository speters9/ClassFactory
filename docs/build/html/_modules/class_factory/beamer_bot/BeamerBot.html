

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>class_factory.beamer_bot.BeamerBot &mdash; classfactory 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />


    <link rel="canonical" href="https://speters9.github.io/ClassFactory/_modules/class_factory/beamer_bot/BeamerBot.html" />
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="../../../index.html" class="icon icon-home">
            classfactory
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../class_factory.html">ClassFactory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../class_factory.beamer_bot.html">BeamerBot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../class_factory.concept_web.html">ConceptWeb</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../class_factory.quiz_maker.html">QuizMaker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../class_factory.utils.html">Utilities</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">classfactory</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">class_factory.beamer_bot.BeamerBot</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <h1>Source code for class_factory.beamer_bot.BeamerBot</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">**BeamerBot**</span>

<span class="sd">This module defines the `BeamerBot` class, which automates the creation of LaTeX Beamer slides for lessons, leveraging a language model (LLM) to generate content based on lesson readings, objectives, and past presentations.</span>

<span class="sd">The module includes the following key functionalities:</span>

<span class="sd">- **Automated Slide Generation**:</span>

<span class="sd">    BeamerBot generates structured LaTeX Beamer slides for each lesson, which include placeholders for specific sections such as:</span>
<span class="sd">    - A current event slide after the title page.</span>
<span class="sd">    - A slide outlining the lesson objectives, with actions in bold (e.g., &quot;Understand the role of government&quot;).</span>
<span class="sd">    - A discussion question slide relevant to the lesson content.</span>
<span class="sd">    - Primary takeaway slides summarizing the main points of the lesson.</span>

<span class="sd">- **Previous Lesson Retrieval**:</span>

<span class="sd">    Automatically retrieves the LaTeX file of the previous lesson as well as current lesson objectives to ensure continuity in slide structure and formatting. If the previous lesson is unavailable, it attempts to retrieve one from earlier lessons.</span>

<span class="sd">- **Customizable Prompts**:</span>

<span class="sd">    The language model is prompted using structured lesson objectives and readings, allowing for custom guidance on what content to generate for each slide.</span>

<span class="sd">- **Validation and Output**:</span>

<span class="sd">    The generated LaTeX is validated to ensure it follows correct formatting before saving to a `.tex` file.</span>

<span class="sd">Dependencies:</span>

<span class="sd">- `langchain_core`: For integrating the language model and managing prompt templates.</span>
<span class="sd">- Custom utilities for reading objectives, validating file paths, loading documents, and logging.</span>

<span class="sd">Usage:</span>

<span class="sd">1. **Initialize BeamerBot**:</span>

<span class="sd">    Create an instance of `BeamerBot` with the lesson number, syllabus path, reading directory, and slide directory. Optionally, you can provide a custom language model.</span>

<span class="sd">2. **Generate Slides**:</span>

<span class="sd">    Call the `generate_slides()` method to produce the LaTeX code for the lesson slides.</span>

<span class="sd">3. **Save the Slides**:</span>

<span class="sd">    Use the `save_slides()` method to save the generated LaTeX content to a file.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span>

<span class="c1"># env setup</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">langchain_core.output_parsers</span> <span class="kn">import</span> <span class="n">JsonOutputParser</span><span class="p">,</span> <span class="n">StrOutputParser</span>
<span class="kn">from</span> <span class="nn">langchain_core.prompts</span> <span class="kn">import</span> <span class="n">PromptTemplate</span>
<span class="kn">from</span> <span class="nn">pyprojroot.here</span> <span class="kn">import</span> <span class="n">here</span>

<span class="c1"># base libraries</span>
<span class="kn">from</span> <span class="nn">class_factory.beamer_bot.slide_preamble</span> <span class="kn">import</span> <span class="n">preamble</span>
<span class="kn">from</span> <span class="nn">class_factory.utils.llm_validator</span> <span class="kn">import</span> <span class="n">Validator</span>
<span class="kn">from</span> <span class="nn">class_factory.utils.load_documents</span> <span class="kn">import</span> <span class="p">(</span><span class="n">extract_lesson_objectives</span><span class="p">,</span>
                                                <span class="n">load_lessons</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">class_factory.utils.response_parsers</span> <span class="kn">import</span> <span class="n">ValidatorResponse</span>
<span class="kn">from</span> <span class="nn">class_factory.utils.slide_pipeline_utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">clean_latex_content</span><span class="p">,</span> <span class="n">comment_out_includegraphics</span><span class="p">,</span> <span class="n">load_beamer_presentation</span><span class="p">,</span>
    <span class="n">validate_latex</span><span class="p">,</span> <span class="n">verify_beamer_file</span><span class="p">,</span> <span class="n">verify_lesson_dir</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">class_factory.utils.tools</span> <span class="kn">import</span> <span class="n">logger_setup</span>

<span class="c1"># %%</span>


<div class="viewcode-block" id="BeamerBot">
<a class="viewcode-back" href="../../../class_factory.beamer_bot.html#class_factory.beamer_bot.BeamerBot.BeamerBot">[docs]</a>
<span class="k">class</span> <span class="nc">BeamerBot</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to generate LaTeX Beamer slides for a given lesson using a language model (LLM).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        lesson_no (int): Lesson number to generate slides for.</span>
<span class="sd">        syllabus_path (Path): Path to the syllabus file.</span>
<span class="sd">        reading_dir (Path): Directory where lesson readings are stored.</span>
<span class="sd">        slide_dir (Path): Directory where Beamer slides are stored.</span>
<span class="sd">        llm: Language model for generating slides.</span>
<span class="sd">        output_dir (Path): Directory where the output Beamer slides should be saved.</span>
<span class="sd">        prompt (str): The generated prompt to be sent to the LLM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lesson_no</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">syllabus_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">reading_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
                 <span class="n">slide_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">llm</span><span class="p">,</span> <span class="n">course_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes BeamerBot with lesson number, paths, and the LLM instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            lesson_no (int): Lesson number to generate slides for.</span>
<span class="sd">            syllabus_path (Path): Path to the syllabus file.</span>
<span class="sd">            reading_dir (Path): Directory where lesson readings are stored.</span>
<span class="sd">            slide_dir (Path): Directory where Beamer slides are stored.</span>
<span class="sd">            llm: Language model for generating slides.</span>
<span class="sd">            output_dir (Optional[Path]): Directory where the output Beamer slides should be saved. Defaults to slide_dir.</span>
<span class="sd">            verbose (bool): Whether to output verbose logs. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span> <span class="o">=</span> <span class="n">lesson_no</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">syllabus_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">syllabus_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reading_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">reading_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slide_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">slide_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">llm</span> <span class="o">=</span> <span class="n">llm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">slide_dir</span> <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">output_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">llm_response</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">course_name</span> <span class="o">=</span> <span class="n">course_name</span>

        <span class="c1"># setup logging</span>
        <span class="n">log_level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span> <span class="k">if</span> <span class="n">verbose</span> <span class="k">else</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger_setup</span><span class="p">(</span><span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;beamerbot_logger&quot;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="n">log_level</span><span class="p">)</span>

        <span class="c1"># Verify that the reading directory exists for this lesson</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">verify_lesson_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reading_dir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lesson </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="si">}</span><span class="s2"> readings directory does not exist or is empty.&quot;</span><span class="p">)</span>

        <span class="c1"># Verify the Beamer file from the previous lesson</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beamer_example</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_prior_lesson</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">verify_beamer_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beamer_example</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Beamer file for Lesson </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reading_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;L</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="si">}</span><span class="s1">/&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beamer_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;L</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="si">}</span><span class="s1">.tex&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_readings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="p">,</span> <span class="n">parser</span><span class="o">=</span><span class="n">JsonOutputParser</span><span class="p">(</span><span class="n">pydantic_object</span><span class="o">=</span><span class="n">ValidatorResponse</span><span class="p">))</span>

<div class="viewcode-block" id="BeamerBot.load_readings">
<a class="viewcode-back" href="../../../class_factory.beamer_bot.html#class_factory.beamer_bot.BeamerBot.BeamerBot.load_readings">[docs]</a>
    <span class="k">def</span> <span class="nf">load_readings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the lesson readings from the directory using the standardized `load_lessons` method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Combined lesson readings as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">load_lessons</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">lesson_range</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span></div>


<div class="viewcode-block" id="BeamerBot.find_prior_lesson">
<a class="viewcode-back" href="../../../class_factory.beamer_bot.html#class_factory.beamer_bot.BeamerBot.BeamerBot.find_prior_lesson">[docs]</a>
    <span class="k">def</span> <span class="nf">find_prior_lesson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lesson_no</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">max_attempts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dynamically finds the most recent prior lesson to use as a template for slide creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            lesson_no (int): The current lesson number.</span>
<span class="sd">            max_attempts (int): The maximum number of previous lessons to attempt loading (default 3).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path: The path to the found Beamer file from a prior lesson.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: If no valid prior lesson file is found within the `max_attempts` range.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_attempts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">prior_lesson</span> <span class="o">=</span> <span class="n">lesson_no</span> <span class="o">-</span> <span class="n">i</span>
            <span class="n">beamer_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slide_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;L</span><span class="si">{</span><span class="n">prior_lesson</span><span class="si">}</span><span class="s1">.tex&#39;</span>
            <span class="k">if</span> <span class="n">verify_beamer_file</span><span class="p">(</span><span class="n">beamer_file</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found prior lesson: Lesson </span><span class="si">{</span><span class="n">prior_lesson</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">beamer_file</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No prior Beamer file found within the last </span><span class="si">{</span><span class="n">max_attempts</span><span class="si">}</span><span class="s2"> lessons.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="BeamerBot.load_prior_lesson">
<a class="viewcode-back" href="../../../class_factory.beamer_bot.html#class_factory.beamer_bot.BeamerBot.BeamerBot.load_prior_lesson">[docs]</a>
    <span class="k">def</span> <span class="nf">load_prior_lesson</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the previous lesson&#39;s Beamer presentation as a string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Previous lesson&#39;s LaTeX content.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">load_beamer_presentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beamer_example</span><span class="p">)</span></div>


<div class="viewcode-block" id="BeamerBot.generate_prompt">
<a class="viewcode-back" href="../../../class_factory.beamer_bot.html#class_factory.beamer_bot.BeamerBot.BeamerBot.generate_prompt">[docs]</a>
    <span class="k">def</span> <span class="nf">generate_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate the LLM prompt based on the lesson objectives, readings, and prior lesson content.</span>

<span class="sd">        Args:</span>
<span class="sd">            objectives_text (str): The objectives for the current lesson.</span>
<span class="sd">            combined_readings_text (str): The combined readings for the lesson.</span>
<span class="sd">            prior_lesson (str): The previous lesson&#39;s LaTeX content.</span>
<span class="sd">            course_name (str): The name of the course being instructed</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The prompt string to be sent to the LLM.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        You are a LaTeX Beamer specialist and a political scientist with expertise in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">course_name</span><span class="si">}</span><span class="s2">.</span>
<span class="s2">        You will be creating the content for a college-level lesson based on the following texts and objectives.</span>
<span class="s2">        We are on lesson </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="si">}</span><span class="s2">. Here are the objectives for this lesson.</span>
<span class="s2">        ---</span>
<span class="s2">        </span><span class="se">{{</span><span class="s2">objectives</span><span class="se">}}</span>
<span class="s2">        ---</span>
<span class="s2">        Here are the texts for this lesson:</span>
<span class="s2">        ---</span>
<span class="s2">        </span><span class="se">{{</span><span class="s2">information</span><span class="se">}}</span><span class="s2">.</span>
<span class="s2">        ---</span>
<span class="s2">        ### General Format to follow:</span>
<span class="s2">          - Each slide should have a title and content, with the content being points that work toward the lesson objectives.</span>
<span class="s2">          - The lessons should always include a slide placeholder for a student current event presentation after the title page,</span>
<span class="s2">              then move on to where we are in the course, what we did last lesson (Lesson </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">),</span>
<span class="s2">              and the lesson objectives for that day. The action in each lesson objective should be bolded (e.g. &#39;</span><span class="se">\\</span><span class="s2">textbf(Understand) the role of government.&#39;)</span>
<span class="s2">          - After that we should include a slide with an open-ended and thought-provoking discussion question relevant to the subject matter.</span>
<span class="s2">          - The slides should conclude with the three primary takeaways from the lesson, hitting on the lesson points students should remember the most.</span>

<span class="s2">        This lesson specifically should discuss:</span>
<span class="s2">        ---</span>
<span class="s2">        </span><span class="se">{{</span><span class="s2">specific_guidance</span><span class="se">}}</span>
<span class="s2">        ---</span>
<span class="s2">        One slide should also include an exercise the students might engage in to help with their learning.</span>
<span class="s2">        This exercise should happen in the middle of the lesson, to get students re-energized.</span>

<span class="s2">        Use the prior lesson’s presentation as an example:</span>
<span class="s2">        ---</span>
<span class="s2">        </span><span class="se">{{</span><span class="s2">last_presentation</span><span class="se">}}</span>
<span class="s2">        ---</span>
<span class="s2">        </span><span class="se">{{</span><span class="s2">additional_guidance</span><span class="se">}}</span>
<span class="s2">        ---</span>
<span class="s2">        ### IMPORTANT:</span>
<span class="s2">         - You **must** strictly follow the LaTeX format. Your response should **only** include LaTeX code without any extra explanations.</span>
<span class="s2">         - Start your response at the point in the preamble where we call `</span><span class="se">\\</span><span class="s2">title`.</span>
<span class="s2">         - Ensure the LaTeX code is valid, and do not include additional text outside the code blocks.</span>
<span class="s2">         - Failure to follow this will result in the output being rejected.</span>

<span class="s2">        ### Example of Expected Output:</span>
<span class="s2">            </span><span class="se">\\</span><span class="s2">title</span><span class="se">{{{{</span><span class="s2">Lesson 5: Interest Groups</span><span class="se">}}}}</span>
<span class="s2">            </span><span class="se">\\</span><span class="s2">begin</span><span class="se">{{{{</span><span class="s2">document</span><span class="se">}}}}</span>
<span class="s2">            </span><span class="se">\\</span><span class="s2">maketitle</span>
<span class="s2">            </span><span class="se">\\</span><span class="s2">section</span><span class="se">{{{{</span><span class="s2">Lesson Overview</span><span class="se">}}}}</span>
<span class="s2">            </span><span class="se">\\</span><span class="s2">begin</span><span class="se">{{{{</span><span class="s2">frame</span><span class="se">}}}}</span>
<span class="s2">            </span><span class="se">\\</span><span class="s2">titlepage</span>
<span class="s2">            </span><span class="se">\\</span><span class="s2">end</span><span class="se">{{{{</span><span class="s2">frame</span><span class="se">}}}}</span>
<span class="s2">            ...</span>
<span class="s2">            </span><span class="se">\\</span><span class="s2">end</span><span class="se">{{{{</span><span class="s2">document</span><span class="se">}}}}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">prompt</span></div>


<div class="viewcode-block" id="BeamerBot.generate_slides">
<a class="viewcode-back" href="../../../class_factory.beamer_bot.html#class_factory.beamer_bot.BeamerBot.BeamerBot.generate_slides">[docs]</a>
    <span class="k">def</span> <span class="nf">generate_slides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specific_guidance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">latex_compiler</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pdflatex&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate the Beamer slides for the lesson using the language model (LLM).</span>

<span class="sd">        Args:</span>
<span class="sd">            specific_guidance (Optional[str]): Specific guidance for the lesson content. Defaults to None.</span>
<span class="sd">            latex_compiler (str): The full path or name of the LaTeX compiler executable if it&#39;s not on the PATH.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Generated LaTeX content for the slides.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Load objectives, readings, and previous lesson slides</span>
        <span class="n">objectives_text</span> <span class="o">=</span> <span class="n">extract_lesson_objectives</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">syllabus_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lesson_no</span><span class="p">)</span>
        <span class="n">combined_readings_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readings</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">slide_dir</span><span class="p">:</span>
            <span class="n">prior_lesson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_prior_lesson</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prior_lesson</span> <span class="o">=</span> <span class="s2">&quot;Not Provided&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No slide_dir provided. Prior slides will not be referenced during generation. &quot;</span>
                <span class="s2">&quot;If this is unintentional, please check BeamerBot configuration for slide_dir.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_prompt</span><span class="p">()</span>

        <span class="c1"># Create the LLM prompt chain</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">StrOutputParser</span><span class="p">()</span>
        <span class="n">prompt_template</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="p">)</span>
        <span class="n">chain</span> <span class="o">=</span> <span class="n">prompt_template</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm</span> <span class="o">|</span> <span class="n">parser</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Generate Beamer slides via the chain</span>
        <span class="n">additional_guidance</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">retries</span><span class="p">,</span> <span class="n">MAX_RETRIES</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="n">valid</span> <span class="ow">and</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="n">MAX_RETRIES</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">invoke</span><span class="p">({</span>
                <span class="s2">&quot;objectives&quot;</span><span class="p">:</span> <span class="n">objectives_text</span><span class="p">,</span>
                <span class="s2">&quot;information&quot;</span><span class="p">:</span> <span class="n">combined_readings_text</span><span class="p">,</span>
                <span class="s2">&quot;last_presentation&quot;</span><span class="p">:</span> <span class="n">prior_lesson</span><span class="p">,</span>
                <span class="s1">&#39;specific_guidance&#39;</span><span class="p">:</span> <span class="n">specific_guidance</span> <span class="k">if</span> <span class="n">specific_guidance</span> <span class="k">else</span> <span class="s2">&quot;Not provided.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;additional_guidance&quot;</span><span class="p">:</span> <span class="n">additional_guidance</span>
            <span class="p">})</span>

            <span class="n">val_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_llm_response</span><span class="p">(</span><span class="n">generated_slides</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
                                                      <span class="n">objectives</span><span class="o">=</span><span class="n">objectives_text</span><span class="p">,</span>
                                                      <span class="n">readings</span><span class="o">=</span><span class="n">combined_readings_text</span><span class="p">,</span>
                                                      <span class="n">last_presentation</span><span class="o">=</span><span class="n">prior_lesson</span><span class="p">,</span>
                                                      <span class="n">prompt_specific_guidance</span><span class="o">=</span><span class="n">specific_guidance</span> <span class="k">if</span> <span class="n">specific_guidance</span> <span class="k">else</span> <span class="s2">&quot;Not provided.&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation output: </span><span class="si">{</span><span class="n">val_response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">val_response</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">valid</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retries</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">additional_guidance</span> <span class="o">=</span> <span class="n">val_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;additional_guidance&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response validation failed on attempt </span><span class="si">{</span><span class="n">retries</span><span class="si">}</span><span class="s2">. &quot;</span>
                                              <span class="sa">f</span><span class="s2">&quot;Guidance for improvement: </span><span class="si">{</span><span class="n">additional_guidance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Handle validation failure after max retries</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Validation failed after max retries. Ensure correct prompt and input data. Consider trying a different LLM.&quot;</span><span class="p">)</span>

        <span class="c1"># Clean and format the LaTeX output</span>
        <span class="n">cleaned_latex</span> <span class="o">=</span> <span class="n">clean_latex_content</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="n">full_latex</span> <span class="o">=</span> <span class="n">preamble</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">comment_out_includegraphics</span><span class="p">(</span><span class="n">cleaned_latex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">llm_response</span> <span class="o">=</span> <span class="n">full_latex</span>

        <span class="c1"># Validate the LaTeX code</span>
        <span class="n">is_valid_latex</span> <span class="o">=</span> <span class="n">validate_latex</span><span class="p">(</span><span class="n">full_latex</span><span class="p">,</span> <span class="n">latex_compiler</span><span class="o">=</span><span class="n">latex_compiler</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">is_valid_latex</span><span class="p">,</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">LaTeX code is invalid. This issue may resolve with a second model run. &quot;</span>
            <span class="s2">&quot;If the error persists, please review the LLM output for potential causes. &quot;</span>
            <span class="s2">&quot;You can inspect the model output via the &#39;llm_response&#39; object (BeamerBot.llm_response). &quot;</span>
            <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Note: Compilation issues may stem from syntax errors in the example LaTeX code provided to the model.&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">full_latex</span></div>


<div class="viewcode-block" id="BeamerBot.validate_llm_response">
<a class="viewcode-back" href="../../../class_factory.beamer_bot.html#class_factory.beamer_bot.BeamerBot.BeamerBot.validate_llm_response">[docs]</a>
    <span class="k">def</span> <span class="nf">validate_llm_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generated_slides</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">objectives</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">readings</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">last_presentation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                              <span class="n">prompt_specific_guidance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">additional_guidance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate the generated quiz questions by sending them to the validator for quality and accuracy checks.</span>

<span class="sd">        Args:</span>
<span class="sd">            quiz_questions (Dict[str, Any]): The generated quiz questions from the LLM, structured as a dictionary.</span>
<span class="sd">            objectives (str): Lesson objectives to provide context for validation.</span>
<span class="sd">            readings (str): Text content of the lesson readings, used to evaluate the relevance of generated questions.</span>
<span class="sd">            last_presentation (str): The prior presentation used as format guide for the new presentation.</span>
<span class="sd">            specific_guidance (Optional, str): Manual prompt adjustments passed by the user at runtime.</span>
<span class="sd">            additional_guidance (Optional,str): Extra guidance provided to the validator to improve response accuracy.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, Any]: A dictionary containing the validation response, which includes fields such as</span>
<span class="sd">                            &quot;evaluation_score,&quot; &quot;status,&quot; &quot;reasoning,&quot; and &quot;additional_guidance.&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate quiz quality and accuracy</span>
        <span class="n">val_template</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="p">)</span>
        <span class="n">response_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">generated_slides</span><span class="p">)</span>
        <span class="n">validation_prompt</span> <span class="o">=</span> <span class="n">val_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">course_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">course_name</span><span class="p">,</span>
                                                <span class="n">objectives</span><span class="o">=</span><span class="n">objectives</span><span class="p">,</span>
                                                <span class="n">information</span><span class="o">=</span><span class="n">readings</span><span class="p">,</span>
                                                <span class="n">last_presentation</span><span class="o">=</span><span class="n">last_presentation</span><span class="p">,</span>
                                                <span class="n">additional_guidance</span><span class="o">=</span><span class="n">additional_guidance</span><span class="p">,</span>
                                                <span class="n">specific_guidance</span><span class="o">=</span><span class="n">prompt_specific_guidance</span>
                                                <span class="p">)</span>
        <span class="n">val_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">task_description</span><span class="o">=</span><span class="n">validation_prompt</span><span class="p">,</span>
                                               <span class="n">generated_response</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span>
                                               <span class="n">specific_guidance</span><span class="o">=</span><span class="s2">&quot;Pay attention to the concepts introduced and their accuracy with respect to the texts.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">val_response</span></div>


<div class="viewcode-block" id="BeamerBot.save_slides">
<a class="viewcode-back" href="../../../class_factory.beamer_bot.html#class_factory.beamer_bot.BeamerBot.BeamerBot.save_slides">[docs]</a>
    <span class="k">def</span> <span class="nf">save_slides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latex_content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the generated LaTeX content to a .tex file.</span>

<span class="sd">        Args:</span>
<span class="sd">            latex_content (str): The LaTeX content to save.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beamer_output</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">latex_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Slides saved to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">beamer_output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">langchain_community.llms</span> <span class="kn">import</span> <span class="n">Ollama</span>
    <span class="kn">from</span> <span class="nn">langchain_openai</span> <span class="kn">import</span> <span class="n">ChatOpenAI</span>

    <span class="kn">from</span> <span class="nn">class_factory.utils.tools</span> <span class="kn">import</span> <span class="n">reset_loggers</span>

    <span class="n">wd</span> <span class="o">=</span> <span class="n">here</span><span class="p">()</span>
    <span class="n">load_dotenv</span><span class="p">()</span>

    <span class="n">user_home</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>

    <span class="n">reset_loggers</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="n">OPENAI_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;openai_key&#39;</span><span class="p">)</span>
    <span class="n">OPENAI_ORG</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;openai_org&#39;</span><span class="p">)</span>

    <span class="c1"># Paths for readings, slides, and syllabus</span>
    <span class="n">reading_dir</span> <span class="o">=</span> <span class="n">user_home</span> <span class="o">/</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;readingsDir&#39;</span><span class="p">)</span>
    <span class="n">slide_dir</span> <span class="o">=</span> <span class="n">user_home</span> <span class="o">/</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;slideDir&#39;</span><span class="p">)</span>
    <span class="n">syllabus_path</span> <span class="o">=</span> <span class="n">user_home</span> <span class="o">/</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;syllabus_path&#39;</span><span class="p">)</span>

    <span class="n">llm</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4o-mini&quot;</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
        <span class="n">max_tokens</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">api_key</span><span class="o">=</span><span class="n">OPENAI_KEY</span><span class="p">,</span>
        <span class="n">organization</span><span class="o">=</span><span class="n">OPENAI_ORG</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># llm = Ollama(</span>
    <span class="c1">#     model=&quot;llama3.1&quot;,</span>
    <span class="c1">#     temperature=0.2</span>
    <span class="c1"># )</span>

    <span class="n">specific_guidance</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    The lesson should be structured in a way that discusses big picture ideas about political parties and their influence.</span>
<span class="s2">    The slides will, at a minimum, cover the following:</span>
<span class="s2">               - The role of parties in government and society</span>
<span class="s2">               - How parties have changed over time</span>
<span class="s2">               - Relating parties to Tocqueville&#39;s notion of associations</span>
<span class="s2">               - Have a slide for each of the 5 functions of parties: Recruit Candidates​, Nominate Candidates​, Get Out the Vote (GOTV)​, Facilitate Electoral Choice, Influence National Government​</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialize the BeamerBot</span>
    <span class="n">beamer_bot</span> <span class="o">=</span> <span class="n">BeamerBot</span><span class="p">(</span>
        <span class="n">lesson_no</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">syllabus_path</span><span class="o">=</span><span class="n">syllabus_path</span><span class="p">,</span>
        <span class="n">reading_dir</span><span class="o">=</span><span class="n">reading_dir</span><span class="p">,</span>
        <span class="n">slide_dir</span><span class="o">=</span><span class="n">slide_dir</span><span class="p">,</span>
        <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
        <span class="n">course_name</span><span class="o">=</span><span class="s2">&quot;American Government&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># Generate slides for Lesson 20</span>
    <span class="n">generated_slides</span> <span class="o">=</span> <span class="n">beamer_bot</span><span class="o">.</span><span class="n">generate_slides</span><span class="p">(</span><span class="n">specific_guidance</span><span class="o">=</span><span class="n">specific_guidance</span><span class="p">)</span>

    <span class="c1"># Save the generated LaTeX slides</span>
    <span class="c1"># beamer_bot.save_slides(generated_slides)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sean Peters.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
